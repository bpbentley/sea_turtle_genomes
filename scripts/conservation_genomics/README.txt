List of steps and associated scripts for the conservaton genomics analyses of sea turtle genomes used in Bentley et al. (2022). Each step contains the bash scripts used to generate the relevant data (in chronological order), and an R-script used to summarize and visualize these data.

1. Pre-processing of reads: These scripts are used for processing the raw reads (either 10X linked reads (reference individuals) or Illumina reads (resequenced individuals)), aligning to the genome(s), removing duplicates, adding read group headers, and re-aligning around INDELs.
  a. 01_proc10x.sh - processes the 10X linked reads as per https://github.com/ucdavis-bioinformatics/proc10xG.
  b. 02_trim_align.sh - trims the "raw" reads (raw Illumina or processed 10X) using Trimmomatic, and aligns to the reference genomes using BWA-mem, before sorting,     indexing and generating alignment and depth metrics.
  c. 03_duplicate_removal.sh - uses PicardTools to identify and remove reads flagged as PCR duplicates. Generates duplicate and depth metrics.
  d. 04_add_RG.sh - uses PicardTools to add Read Group headers to BAM files for downstream use with ANGSD and GATK.
  e. 05_indel_realign.sh - uses GATK (version < 4.0) to re-align around INDELs for use with ANGSD. GATK versions greater than 4.0 does this automatically.
  
2. Heterozygosity estimations: These scripts are used to generate heterozygosity estimates from a number of genomic regions. We GATK and a sliding-window approach similar to that presented in Robinson et al. (2016) and Morrin et al. (2021). Dependencies found in sub-directory "gatk_scripts." Note that these are configured to run as an array with each chromosome a separate batch job (1-28).
  a. 06_GATK_genome.sh - calculates heterozygosity in 100 kb non-overlapping sliding windows across the length of the genomes.
  b. 07_GATK_repeat_masked.sh - as above but only includes sites that aren't masked as repeats or complex regions (e.g. TEs).
  c. 08_GATK_exons.sh - uses a BED file of exons pulled from the annotations to only include loci within coding regions.
  d. 09_GATK_nonexons.sh - the inverse bed file of the exon run. These are the NON-CODING loci.
  e. heterozygosity_plot_estimates.R - R script to summarize and visualize the heterozygosity data.
  
3. Runs of homozygosity: These scripts are used to generate inputs for PLINK ROH analyses using ANGSD.
  a. 10_ANGSD_for_PLINK.sh - generate a SNP list using genotype likelihoods in the from of PLINK files (.tped, .tfam) for use in the ROH analysis.
  b. 11_PLINK_ROH.sh - analysis of runs of homozygosity using the PLINK files generated by ANGSD.
  c. ROH_plot_summary.R - summarize and visualize the ROH outputs. ROH size categories outlined in Ochoa & Gibbs (2021).
  
4. Genetic load: These scripts describe the method of using the gVCF files generated in (2) to joint-genotype and select variants for use with snpEff for genetic load estimates.
  a. 12_combine_gVCFs.sh - combine the gVCFs generated in (2).
  b. 13_genomicsDBimport.sh - import the gVCFs into a genomicsDB with GATK.
  c. 14_genotypeJointgVCFs.sh - joint genotpye the combined gVCF files with GATK.
  d. 15_select_variants.sh - select only SNPs and INDELS using GATK.
  e. 16_filter_variants.sh - all variants are still in the output VCF at thise stage. This script filters the VCF for mean depth and minor allele ferquency to only retain high-quality calls.
  f. 17_snpEff.sh - use snpEff with the joint-genotyped VCFs and annotation to determine the putative impacts of the identified variants.
  g. genetic_load_summary.R - R-script that summarizes and plots the outputs generated by snpEff.
    
5. Demographic history: scripts associated with modeling demographic history using pairwise sequential Markovian coalescence (PSMC).
  a. 18_PSMC.sh - script that calls variants, filters based on allelic balance and depth, runs PSMC and plots outputs.
